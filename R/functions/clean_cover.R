# clean cover data
clean_cover <- function(community_clean, metaTurfID){
  
  ### FIX MISIDENTIFICAITONS OR WRONG ENTRIES IN THE DATA
  # The following data frames fix misidentification of species, change species names, or problems in the data
  # All these changes need to be done in community data frame when producing cover and CommunitySubplot
  
  ## Changes species names
  # Fixes misidentification, or change uncertainties in species names containing cf to species or vice versa according to data in other years of pictures
  fix_species = tibble::tribble(
    ~year, ~turfID, ~species, ~species_new,
    2019, "1 WN1M 84", "Antennaria alpina cf", "Antennaria sp",
    2020, "1 WN1M 84", "Antennaria dioica cf", "Antennaria sp",
    2021, "1 WN1M 84", "Erigeron sp", "Erigeron uniflorus",
    2021, "1 WN1M 84", "Luzula sp", "Luzula spicata cf",
    2019, "1 WN1M 84", "Festuca ovina", "Nardus stricta",
    2021, "1 WN1M 84", "Festuca ovina", "Nardus stricta",
    2022, "3 WN1C 85", "Antennaria sp", "Antennaria alpina cf",
    2019, "5 WN1I 86", "Antennaria alpina cf", "Antennaria sp",
    2020, "5 WN1I 86", "Antennaria dioica cf", "Antennaria sp",
    2021, "8 WN1N 87", "Luzula sp", "Luzula spicata cf",
    2022, "8 WN1N 87", "Luzula sp", "Luzula spicata cf",
    2021, "10 WN6M 89", "Luzula sp", "Luzula spicata cf",
    2019, "13 WN6C 90", "Antennaria alpina cf", "Antennaria dioica",
    2021, "13 WN6C 90", "Antennaria dioica cf", "Antennaria dioica",
    2021, "14 WN6I 92", "Luzula sp", "Luzula spicata cf",
    2021, "94 AN6I 94", "Festuca ovina", "Festuca rubra",
    2021, "15 WN6N 95", "Antennaria sp", "Antennaria alpina cf",
    2019, "15 WN6N 95", "Luzula spicata cf", "Luzula sp",
    2021, "19 WN5I 97", "Antennaria sp", "Antennaria dioica cf",
    2021, "21 WN5C 99", "Antennaria sp", "Antennaria alpina cf",
    2021, "22 WN5M 102", "Antennaria sp", "Antennaria alpina cf",
    2019, "24 WN5N 103", "Taraxacum sp.", "Leontodon autumnalis",
    2019, "26 WN3I 105", "Taraxacum sp.", "Leontodon autumnalis",
    2019, "26 WN3I 105", "Luzula spicata cf", "Luzula sp",
    2020, "26 WN3I 105", "Luzula multiflora cf", "Luzula sp",
    2021, "29 WN3C 106", "Antennaria sp", "Antennaria alpina cf",
    2019, "29 WN3C 106", "Taraxacum sp.", "Leontodon autumnalis",
    2019, "29 WN3C 106", "Luzula spicata cf", "Luzula spicata",
    2020, "29 WN3C 106", "Luzula spicata cf", "Luzula spicata",
    2021, "29 WN3C 106", "Luzula spicata cf", "Luzula spicata",
    2021, "30 WN3M 107", "Antennaria sp", "Antennaria alpina cf",
    2022, "30 WN3M 107", "Antennaria dioica cf", "Antennaria alpina cf",
    2021, "30 WN3M 107", "Luzula sp", "Luzula multiflora cf",
    2022, "30 WN3M 107", "Luzula sp", "Luzula multiflora cf",
    2019, "32 WN3N 112", "Luzula spicata cf", "Luzula sp",
    2021, "34 WN10I 114", "Antennaria sp", "Antennaria dioica cf",
    2021, "34 WN10I 114", "Luzula sp", "Luzula spicata cf",
    2022, "34 WN10I 114", "Luzula sp", "Luzula spicata cf",
    2022, "34 WN10I 114", "Potentilla erecta", "Potentilla crantzii",
    2019, "36 WN10M 115", "Taraxacum sp.", "Leontodon autumnalis",
    2021, "37 WN10C 116", "Antennaria sp", "Antennaria dioica cf",
    2019, "42 WN7I 123", "Antennaria alpina cf", "Antennaria sp",
    2019, "44 WN7M 125", "Taraxacum sp.", "Leontodon autumnalis",
    2021, "53 WN4C 133", "Antennaria sp", "Antennaria alpina cf",
    2019, "53 WN4C 133", "Taraxacum sp.", "Leontodon autumnalis",
    2021, "53 WN4C 133", "Erigeron sp", "Erigeron uniflorus",
    2021, "54 WN4I 134", "Erigeron sp", "Erigeron uniflorus",
    2019, "54 WN4I 134", "Salix reticulata", "Vaccinium uliginosum",
    2019, "54 WN4I 134", "Taraxacum sp.", "Leontodon autumnalis",
    2019, "61 WN8I 140", "Luzula spicata cf", "Luzula sp",
    2019, "64 WN8N 143", "Luzula spicata cf", "Luzula sp",
    2021, "71 WN9N 151", "Luzula multiflora cf", "Luzula multiflora",
    2019, "71 WN9N 151", "Luzula spicata cf", "Luzula multiflora",
    2019, "73 WN2M 153", "Leontodon autumnalis", "Taraxacum sp.",
    2019, "73 WN2M 153", "Luzula spicata cf", "Luzula spicata",
    2020, "73 WN2M 153", "Luzula multiflora cf", "Luzula spicata",
    2021, "73 WN2M 153", "Luzula sp", "Luzula spicata",
    2022, "73 WN2M 153", "Luzula spicata cf", "Luzula spicata",
    
    2020, "154 AN2M 154", "Vaccinium uliginosum", "Vaccinium vitis-idaea",
    2019, "139 AN8I 139", "Carex small bigelowii", "Carex pilulifera cf",
    2019, "142 AN8C 142", "Carex small bigelowii", "Carex pilulifera cf",
    2021, "144 AN8N 144", "Carex pilulifera cf", "Carex bigelowii",
    2019, "146 AN9I 146", "Carex small bigelowii", "Carex pilulifera cf",
    2019, "149 AN9C 149", "Carex small bigelowii", "Carex bigelowii",
    2019, "152 AN9N 152", "Carex small bigelowii", "Carex brunnescens cf",
    2019, "156 AN2C 156", "Carex small bigelowii", "Carex pilulifera cf",
    2022, "156 AN2C 156", "Carex sp", "Carex pilulifera cf",
    2021, "156 AN2C 156", "Carex bigelowii cf", "Carex bigelowii",
    2021, "157 AN2I 157", "Carex pilulifera cf", "Carex bigelowii",
    2022, "157 AN2I 157", "Carex sp", "Carex brunnescens cf",
    2019, "138 WN8I 189", "Carex small bigelowii", "Carex bigelowii",
    2019, "141 WN8M 191", "Carex small bigelowii", "Carex bigelowii",
    2019, "145 WN9M 193", "Carex small bigelowii", "Carex pilulifera cf",
    2021, "145 WN9M 193", "Carex sp", "Carex pilulifera cf",
    2022, "145 WN9M 193", "Carex sp", "Carex bigelowii",
    2019, "147 WN9C 194", "Carex small bigelowii", "Carex bigelowii",
    2019, "151 WN9N 196", "Carex small bigelowii", "Carex bigelowii",
    2021, "153 WN2I 197", "Carex sp", "Carex bigelowii",
    
    2022, "2 AN1M 2", "Orchid sp", "Coeloglossum viride",
    2019, "4 AN1C 4", "Antennaria alpina cf", "Antennaria dioica",
    2020, "4 AN1C 4", "Antennaria dioica cf", "Antennaria dioica",
    2021, "4 AN1C 4", "Antennaria sp", "Antennaria dioica",
    2022, "4 AN1C 4", "Antennaria alpina cf", "Antennaria dioica",
    2021, "6 AN1I 6", "Antennaria sp", "Antennaria alpina cf",
    2021, "7 AN1N 7", "Antennaria sp", "Antennaria alpina cf",
    2019, "9 AN6M 9", "Achillea millefolium", "Alchemilla alpina",
    2021, "9 AN6M 9", "Antennaria dioica cf", "Antennaria alpina cf",
    2022, "9 AN6M 9", "Antennaria sp", "Antennaria alpina cf",
    2019, "9 AN6M 9", "Avenella flexuosa", "Festuca rubra",
    2019, "9 AN6M 9", "Leontodon autumnalis", "Taraxacum sp.",
    2019, "11 AN6I 11", "Antennaria alpina cf", "Antennaria sp",
    2019, "11 AN6I 11", "Antennaria dioica cf", "Antennaria sp",
    2019, "11 AN6I 11", "Taraxacum sp.", "Leontodon autumnalis",
    2022, "11 AN6I 11", "Luzula sp.", "Luzula spicata cf",
    2019, "16 AN6N 16", "Astragalus alpina", "Oxytropa laponica",
    2019, "16 AN6N 16", "Antennaria alpina cf", "Antennaria sp",
    2022, "16 AN6N 16", "Antennaria dioica cf", "Antennaria sp",
    2019, "17 AN5M 17", "Antennaria dioica cf", "Antennaria dioica",
    2021, "17 AN5M 17", "Antennaria dioica cf", "Antennaria dioica",
    2022, "17 AN5M 17", "Antennaria sp", "Antennaria dioica",
    2019, "18 AN5C 18", "Antennaria dioica cf", "Antennaria dioica",
    2021, "18 AN5C 18", "Antennaria dioica cf", "Antennaria dioica",
    2022, "18 AN5C 18", "Antennaria sp", "Antennaria dioica",
    2019, "23 AN5N 23", "Antennaria dioica cf", "Antennaria dioica",
    2021, "23 AN5N 23", "Antennaria dioica cf", "Antennaria dioica",
    2019, "27 AN3C 27", "Deschampsia cespitosa", "Deschampsia alpina",
    2020, "27 AN3C 27", "Deschampsia cespitosa", "Deschampsia alpina",
    2019, "27 AN3C 27", "Taraxacum sp.", "Leontodon autumnalis",
    2019, "27 AN3C 27", "Luzula multiflora", "Luzula multiflora cf",
    2020, "27 AN3C 27", "Luzula spicata cf", "Luzula spicata",
    2021, "27 AN3C 27", "Luzula spicata cf", "Luzula spicata",
    2021, "27 AN3C 27", "Luzula sp", "Luzula spicata",
    2022, "27 AN3C 27", "Luzula spicata cf", "Luzula spicata",
    2019, "28 AN3I 28", "Antennaria alpina cf", "Antennaria sp",
    2019, "28 AN3I 28", "Antennaria dioica cf", "Antennaria sp",
    2020, "28 AN3I 28", "Antennaria dioica cf", "Antennaria sp",
    2022, "28 AN3I 28", "Antennaria alpina cf", "Antennaria sp",
    2021, "28 AN3I 28", "Luzula sp", "Luzula spicata cf",
    2019, "31 AN3N 31", "Deschampsia cespitosa", "Deschampsia alpina",
    2020, "31 AN3N 31", "Deschampsia cespitosa", "Deschampsia alpina",
    2019, "31 AN3N 31", "Luzula spicata cf", "Luzula sp",
    2020, "31 AN3N 31", "Luzula spicata cf", "Luzula sp",
    2020, "31 AN3N 31", "Luzula multiflora cf", "Luzula sp",
    2021, "31 AN3N 31", "Luzula spicata cf", "Luzula sp",
    2022, "31 AN3N 31", "Antennaria sp", "Antennaria dioica cf",
    2019, "33 AN10I 33", "Antennaria alpina cf", "Antennaria sp",
    2019, "33 AN10I 33", "Taraxacum sp.", "Leontodon autumnalis",
    2021, "33 AN10I 33", "Luzula sp", "Luzula spicata cf",
    2022, "33 AN10I 33", "Antennaria alpina cf", "Antennaria sp",
    2019, "35 AN10C 35", "Antennaria alpina cf", "Antennaria sp",
    2019, "38 AN10M 38", "Avenella flexuosa", "Festuca ovina",
    2019, "38 AN10M 38", "Luzula spicata cf", "Luzula spicata",
    2021, "38 AN10M 38", "Luzula sp", "Luzula spicata",
    2019, "38 AN10M 38", "Taraxacum sp.", "Leontodon autumnalis",
    2022, "38 AN10M 38", "Luzula spicata cf", "Luzula spicata",
    2019, "39 AN10N 39", "Deschampsia cespitosa", "Deschampsia alpina",
    2019, "45 AN7I 45", "Antennaria alpina cf", "Antennaria alpina",
    2021, "45 AN7I 45", "Antennaria sp", "Antennaria alpina",
    2022, "45 AN7I 45", "Antennaria sp", "Antennaria alpina",
    2019, "45 AN7I 45", "Deschampsia cespitosa", "Deschampsia alpina",
    2019, "45 AN7I 45", "Taraxacum sp.", "Leontodon autumnalis",
    2019, "46 AN7M 46", "Antennaria alpina cf", "Antennaria sp",
    2022, "46 AN7M 46", "Antennaria sp", "Antennaria dioica cf",
    2022, "46 AN7M 46", "Luzula sp", "Luzula spicata cf",
    2019, "49 AN4I 49", "Antennaria dioica cf", "Antennaria sp",
    2021, "49 AN4I 49", "Antennaria alpina cf", "Antennaria sp",
    2022, "49 AN4I 49", "Antennaria alpina cf", "Antennaria sp",
    2019, "50 AN4M 50", "Taraxacum sp.", "Leontodon autumnalis",
    2019, "52 AN4C 52", "Antennaria dioica cf", "Antennaria alpina",
    2021, "52 AN4C 52", "Antennaria alpina cf", "Antennaria alpina",
    2021, "52 AN4C 52", "Luzula sp", "Luzula spicata",
    2022, "52 AN4C 52", "Antennaria alpina cf", "Antennaria alpina",
    2019, "52 AN4C 52", "Luzula spicata cf", "Luzula spicata",
    2019, "52 AN4C 52", "Viola biflora", "Viola palustris",
    2019, "58 AN8I 58", "Taraxacum sp.", "Leontodon autumnalis",
    2019, "63 AN8N 63", "Taraxacum sp.", "Leontodon autumnalis",
    2022, "63 AN8N 63", "Antennaria sp", "Antennaria alpina cf",
    2019, "68 AN9I 68", "Luzula spicata cf", "Luzula spicata",
    2021, "68 AN9I 68", "Luzula sp", "Luzula spicata",
    2022, "68 AN9I 68", "Luzula sp", "Luzula spicata",
    2022, "68 AN9I 68", "Luzula spicata cf", "Luzula spicata",
    2019, "70 AN9C 70", "Taraxacum sp.", "Leontodon autumnalis",
    2020, "75 AN2I 75", "Luzula spicata cf", "Luzula sp",
    2021, "76 AN2M 76", "Luzula spicata cf", "Luzula sp",
    2021, "79 AN2N 79", "Antennaria dioica cf", "Antennaria alpina cf",
    
    2019, "2 AN1M 2", "Carex brunnescens cf", "Carex vaginata",
    2021, "4 AN1C 4", "Carex norvegica cf", "Carex bigelowii",
    2019, "4 AN1C 4", "Carex small bigelowii", "Carex vaginata",
    2019, "4 AN1C 4", "Carex wide", "Carex atrata cf",
    2019, "9 AN6M 9", "Carex saxatilis cf", "Carex vaginata",
    2019, "11 AN6I 11", "Carex saxatilis cf", "Carex vaginata",
    2019, "11 AN6I 11", "Carex atrata cf", "Carex bigelowii",
    2019, "12 AN6C 12", "Carex atrata cf", "Carex bigelowii",
    2019, "12 AN6C 12", "Carex sp", "Carex vaginata",
    2021, "12 AN6C 12", "Carex pilulifera cf", "Carex vaginata",
    2022, "16 AN6N 16", "Carex atrata cf", "Carex bigelowii",
    2019, "17 AN5M 17", "Carex light green", "Carex vaginata",
    2019, "17 AN5M 17", "Carex panicea cf", "Carex bigelowii",
    2019, "18 AN5C 18", "Carex small bigelowii", "Carex bigelowii",
    2019, "18 AN5C 18", "Carex saxatilis cf", "Carex vaginata",
    2019, "20 AN5I 20", "Carex saxatilis cf", "Carex vaginata",
    2021, "20 AN5I 20", "Carex norvegica cf", "Carex vaginata",
    2021, "25 AN3M 25", "Carex norvegica cf", "Carex bigelowii",
    2019, "25 AN3M 25", "Carex small bigelowii", "Carex norvegica cf",
    2020, "25 AN3M 25", "Carex sp", "Carex rupestris",
    2020, "25 AN3M 25", "Carex dark green", "Carex atrata cf",
    2020, "27 AN3C 27", "Carex sp", "Carex rupestris",
    2019, "28 AN3I 28", "Carex wide", "Carex vaginata",
    2019, "28 AN3I 28", "Carex panicea cf", "Carex atrata cf",
    2019, "28 AN3I 28", "Carex capillaris wide", "Carex rupestris",
    2020, "28 AN3I 28", "Carex sp", "Carex rupestris",
    2020, "28 AN3I 28", "Carex dark green", "Carex norvegica cf",
    2019, "31 AN3N 31", "Carex saxatilis cf", "Carex vaginata",
    2019, "31 AN3N 31", "Carex capillaris wide", "Carex bigelowii",
    2020, "31 AN3N 31", "Carex dark green", "Carex norvegica cf",
    2021, "35 AN10C 35", "Carex norvegica cf", "Carex bigelowii",
    2019, "38 AN10M 38", "Carex saxatilis cf", "Carex vaginata",
    2019, "39 AN10N 39", "Carex capillaris wide", "Carex bigelowii",
    2019, "45 AN7I 45", "Carex saxatilis cf", "Carex vaginata",
    2019, "48 AN7N 48", "Carex atrata cf", "Carex bigelowii",
    2019, "48 AN7N 48", "Carex wide", "Carex vaginata",
    2021, "48 AN7N 48", "Carex norvegica cf", "Carex bigelowii",
    2019, "49 AN4I 49", "Carex saxatilis cf", "Carex vaginata",
    2021, "50 AN4M 50", "Carex rupestris", "Carex capillaris",
    2019, "52 AN4C 52", "Carex saxatilis cf", "Carex vaginata",
    2019, "52 AN4C 52", "Carex atrata cf", "Carex bigelowii",
    2021, "52 AN4C 52", "Carex bigelowii cf", "Carex bigelowii", 
    2019, "55 AN4N 55", "Carex saxatilis cf", "Carex vaginata",
    2021, "55 AN4N 55", "Carex capillaris cf", "Carex capillaris",
    2021, "55 AN4N 55", "Carex panicea cf", "Carex bigelowii",
    2019, "57 AN8C 57", "Carex saxatilis cf", "Carex vaginata",
    2019, "60 AN8M 60", "Carex wide", "Carex vaginata",
    2019, "60 AN8M 60", "Carex panicea cf", "Carex bigelowii",
    2019, "63 AN8N 63", "Carex saxatilis cf", "Carex vaginata",
    2019, "63 AN8N 63", "Carex norvegica cf", "Carex bigelowii",
    2019, "67 AN9M 67", "Carex saxatilis cf", "Carex vaginata",
    2019, "67 AN9M 67", "Carex norvegica cf", "Carex vaginata",
    2019, "67 AN9M 67", "Carex thin", "Carex rupestris cf",
    2019, "68 AN9I 68", "Carex saxatilis cf", "Carex vaginata",
    2019, "70 AN9C 70", "Carex saxatilis cf", "Carex vaginata",
    2019, "72 AN9N 72", "Carex small bigelowii", "Carex bigelowii",
    2019, "75 AN2I 75", "Carex saxatilis cf", "Carex vaginata",
    2019, "76 AN2M 76", "Carex small bigelowii", "Carex vaginata",
    2019, "76 AN2M 76", "Carex atrata cf", "Carex bigelowii",
    2020, "76 AN2M 76", "Carex sp", "Carex sp1",
    2019, "77 AN2C 77", "Carex saxatilis cf", "Carex vaginata",
    2021, "77 AN2C 77", "Carex capillaris cf", "Carex capillaris",
    2019, "77 AN2C 77", "Carex small bigelowii", "Carex sp",
    2019, "79 AN2N 79", "Carex atrata cf", "Carex bigelowii",
    2019, "79 AN2N 79", "Carex small bigelowii", "Carex vaginata",
    
    2019, "1 WN1M 84", "Carex saxatilis cf", "Carex vaginata",
    2020, "1 WN1M 84", "Carex dark green", "Carex vaginata",
    2019, "3 WN1C 85", "Carex small bigelowii", "Carex vaginata",
    2019, "3 WN1C 85", "Carex atrata cf", "Carex bigelowii",
    2019, "5 WN1I 86", "Carex saxatilis cf", "Carex vaginata",
    2019, "5 WN1I 86", "Carex atrata cf", "Carex bigelowii",
    2019, "8 WN1N 87", "Carex small bigelowii", "Carex vaginata",
    2020, "8 WN1N 87", "Carex sp", "Carex rupestris",
    2021, "8 WN1N 87", "Carex dark green", "Carex norvegica cf",
    2019, "10 WN6M 89", "Carex atrata cf", "Carex vaginata",
    2019, "10 WN6M 89", "Carex small bigelowii", "Carex bigelowii",
    2019, "13 WN6C 90", "Carex atrata cf", "Carex bigelowii",
    2019, "13 WN6C 90", "Carex saxatilis cf", "Carex vaginata",
    2019, "14 WN6I 92", "Carex saxatilis cf", "Carex vaginata",
    2021, "14 WN6I 92", "Carex dark green", "Carex norvegica cf",
    2019, "19 WN5I 97", "Carex small bigelowii", "Carex vaginata",
    2019, "21 WN5C 99", "Carex light green", "Carex vaginata",
    2019, "22 WN5M 102", "Carex small bigelowii", "Carex vaginata",
    2019, "26 WN3I 105", "Carex saxatilis cf", "Carex vaginata",
    2020, "26 WN3I 105", "Carex dark green", "Carex sp",
    2019, "29 WN3C 106", "Carex atrata cf", "Carex bigelowii",
    2019, "29 WN3C 106", "Carex saxatilis cf", "Carex vaginata",
    2019, "30 WN3M 107", "Carex atrata cf", "Carex bigelowii",
    2019, "30 WN3M 107", "Carex saxatilis cf", "Carex vaginata",
    2020, "30 WN3M 107", "Carex thin", "Carex rupestris",
    2019, "32 WN3N 112", "Carex atrata cf", "Carex bigelowii",
    2019, "32 WN3N 112", "Carex saxatilis cf", "Carex vaginata",
    2020, "32 WN3N 112", "Carex dark green", "Carex sp",
    2019, "34 WN10I 114", "Carex saxatilis cf", "Carex vaginata",
    2019, "34 WN10I 114", "Carex atrata cf", "Carex bigelowii",
    2021, "34 WN10I 114", "Carex atrata cf", "Carex bigelowii",
    2021, "36 WN10M 115", "Carex atrata cf", "Carex bigelowii",
    2019, "36 WN10M 115", "Carex saxatilis cf", "Carex vaginata",
    2019, "37 WN10C 116", "Carex saxatilis cf", "Carex vaginata",
    2019, "37 WN10C 116", "Carex wide", "Carex bigelowii",
    2021, "37 WN10C 116", "Carex atrata cf", "Carex bigelowii",
    2019, "40 WN10N 119", "Carex brunnescens cf", "Carex bigelowii",
    2019, "41 WN7C 122", "Carex light green", "Carex vaginata",
    2019, "41 WN7C 122", "Carex small bigelowii", "Carex norvegica cf",
    2019, "42 WN7I 123", "Carex saxatilis cf", "Carex vaginata",
    2021, "42 WN7I 123", "Carex norvegica cf", "Carex vaginata",
    2021, "44 WN7M 125", "Carex atrata cf", "Carex bigelowii",
    2019, "47 WN7N 128", "Carex panicea cf", "Carex bigelowii",
    2019, "47 WN7N 128", "Carex light green", "Carex vaginata",
    2021, "47 WN7N 128", "Carex norvegica cf", "Carex vaginata",
    2019, "47 WN7N 128", "Carex small bigelowii", "Carex rupestris",
    2019, "51 WN4M 132", "Carex light green", "Carex vaginata",
    2019, "51 WN4M 132", "Carex atrata cf", "Carex bigelowii",
    2019, "53 WN4C 133", "Carex saxatilis cf", "Carex vaginata",
    2019, "54 WN4I 134", "Carex brunnescens cf", "Carex capillaris",
    2021, "56 WN4N 135", "Carex norvegica cf", "Carex vaginata",
    2019, "59 WN8C 138", "Carex atrata cf", "Carex vaginata",
    2021, "59 WN8C 138", "Carex norvegica cf", "Carex vaginata",
    2019, "61 WN8I 140", "Carex brunnescens cf", "Carex capillaris",
    2021, "61 WN8I 140", "Carex norvegica cf", "Carex pilulifera cf",
    2021, "64 WN8N 143", "Carex norvegica cf", "Carex bigelowii",
    2019, "71 WN9N 151", "Carex small bigelowii", "Carex vaginata",
    2019, "74 WN2C 155", "Carex brunnescens cf", "Carex capillaris",
    2019, "74 WN2C 155", "Carex sp3", "Carex norvegica cf",
    2020, "74 WN2C 155", "Carex norvegica cf", "Carex pilulifera cf",
    2020, "74 WN2C 155", "Carex thin", "Carex sp1",
    2019, "78 WN2I 158", "Carex small bigelowii", "Carex capillaris",
    2021, "78 WN2I 158", "Carex vaginata cf", "Carex vaginata",
    2019, "80 WN2N 159", "Carex light green", "Carex capillaris",
    2019, "80 WN2N 159", "Carex small bigelowii", "Carex norvegica cf",
    2020, "80 WN2N 159", "Carex dark green", "Carex sp",
  )
  
  
  
  ## Fixes cover of species
  # This needs doing if species were merged, added or removed according to other years or pictures
  fix_cover = tibble::tribble(
    ~year, ~turfID, ~species, ~cover_new,
    2020, "83 AN1I 83", "Agrostis capillaris",  34,
    2020, "83 AN1I 83", "Festuca rubra",  16,
    2019, "1 WN1M 84", "Taraxacum sp.", 3,
    2019, "1 WN1M 84", "Festuca ovina",  4,
    2019, "1 WN1M 84", "Festuca rubra",  16,
    2019, "5 WN1I 86", "Festuca rubra",  15,
    2019, "13 WN6C 90", "Avenella flexuosa", 2,
    2019, "14 WN6I 92", "Leontodon autumnalis", 3,
    2019, "21 WN5C 99", "Leontodon autumnalis", 6,
    2019, "30 WN3M 107", "Luzula spicata cf", 1,
    2019, "36 WN10M 115", "Leontodon autumnalis", 6,
    2019, "36 WN10M 115", "Agrostis capillaris", 12,
    2019, "59 WN8C 1385", "Leontodon autumnalis", 17,
    2019, "59 WN8C 1385", "Taraxacum sp.", 8,
    2019, "61 WN8I 140", "Leontodon autumnalis", 4,
    2019, "9 AN6M 9", "Festuca rubra", 2,
    2019, "11 AN6I 11", "Leontodon autumnalis", 4,
    2019, "16 AN6N 16", "Leontodon autumnalis", 2,
    2019, "20 AN5I 20", "Festuca rubra", 17,
    2019, "20 AN5I 20", "Potentilla crantzii", 3,
    2019, "38 AN10M 38", "Leontodon autumnalis", 4,
    2019, "50 AN4M 50", "Leontodon autumnalis", 6,
    2019, "52 AN4C 52", "Antennaria alpina", 4,
    2019, "58 AN8I 58", "Leontodon autumnalis", 4,
    2019, "63 AN8N 63", "Leontodon autumnalis", 3,
    2019, "139 AN8I 139", "Carex bigelowii", 8,
    2019, "139 AN8I 139", "Carex pilulifera cf", 4,
    2019, "142 AN8C 142", "Carex pilulifera cf", 10,
    2021, "160 AN2N 160", "Carex bigelowii", 4,
    2021, "160 AN2N 160", "Carex pilulifera cf", 10,
    2019, "155 WN2M 198", "Carex bigelowii", 3,
    2022, "157 AN2I 157", "Carex brunnescens cf", 3,
    
    2019, "157 AN2I 157", "Carex vaginata", 6,
    2021, "157 AN2I 157", "Carex capillaris", 4,
    2022, "157 AN2I 157", "Carex capillaris", 7,
    
    2020, "2 AN1M 2", "Carex bigelowii", 6,
    2021, "2 AN1M 2", "Carex bigelowii", 5,
    2022, "2 AN1M 2", "Carex atrata cf", 2,
    2019, "7 AN1N 7", "Carex vaginata", 8,
    2020, "7 AN1N 7", "Carex bigelowii", 6,
    2019, "11 AN6I 11", "Carex vaginata", 3,
    2019, "11 AN6I 11", "Carex bigelowii", 5,
    2019, "12 AN6C 12", "Carex bigelowii", 4,
    2019, "17 AN5M 17", "Carex vaginata", 5,
    2019, "17 AN5M 17", "Carex bigelowii", 2,
    2019, "18 AN5C 18", "Carex vaginata", 6,
    2019, "23 AN5N 23", "Carex vaginata", 5,
    2021, "23 AN5N 23", "Carex vaginata", 7,
    2019, "23 AN5N 23", "Carex bigelowii", 3,
    2021, "23 AN5N 23", "Carex bigelowii", 2,
    2019, "27 AN3C 27", "Carex vaginata", 7,
    2020, "27 AN3C 27", "Carex bigelowii", 7,
    2021, "27 AN3C 27", "Carex vaginata", 5,
    2019, "28 AN3I 28", "Carex bigelowii", 4,
    2021, "28 AN3I 28", "Carex vaginata", 6,
    2021, "28 AN3I 28", "Carex norvegica cf", 5,
    2021, "31 AN3N 31", "Carex norvegica cf", 2,
    2021, "31 AN3N 31", "Carex vaginata", 4,
    2021, "31 AN3N 31", "Carex bigelowii", 4,
    2019, "33 AN10I 33", "Carex vaginata", 7,
    2021, "33 AN10I 33", "Carex norvegica cf", 8,
    2019, "35 AN10C 35", "Carex capillaris", 27,
    2021, "38 AN10M 38", "Carex bigelowii", 6,
    2021, "38 AN10M 38", "Carex norvegica cf", 5,
    2021, "39 AN10N 39", "Carex bigelowii", 8,
    2019, "43 AN7C 43", "Carex capillaris", 8,
    2019, "46 AN7M 46", "Carex capillaris", 8,
    2019, "48 AN7N 48", "Carex bigelowii", 7,
    2019, "50 AN4M 50", "Carex vaginata", 10,
    2019, "55 AN4N 55", "Carex capillaris", 16,
    2021, "57 AN8C 57", "Carex vaginata", 4,
    2021, "57 AN8C 57", "Carex norvegica cf", 6,
    2019, "58 AN8I 58", "Carex bigelowii", 6,
    2019, "58 AN8I 58", "Carex vaginata", 7,
    2019, "67 AN9M 67", "Carex bigelowii", 9,
    2019, "67 AN9M 67", "Carex capillaris", 4,
    2019, "68 AN9I 68", "Carex bigelowii", 3,
    2019, "72 AN9N 72", "Carex bigelowii", 8,
    2019, "72 AN9N 72", "Carex vaginata", 5,
    2019, "72 AN9N 72", "Carex capillaris", 3,
    2021, "72 AN9N 72", "Carex bigelowii", 20,
    2021, "72 AN9N 72", "Carex vaginata", 7,
    2019, "75 AN2I 75", "Carex vaginata", 6,
    2019, "75 AN2I 75", "Carex bigelowii", 11,
    2019, "79 AN2N 79", "Carex vaginata", 5,
    2021, "79 AN2N 79", "Carex vaginata", 6,
    2021, "79 AN2N 79", "Carex norvegica cf", 4,
    
    2019, "3 WN1C 85", "Carex bigelowii", 4,
    2020, "3 WN1C 85", "Carex vaginata", 12,
    2020, "5 WN1I 86", "Carex vaginata", 15,
    2020, "8 WN1N 87", "Carex capillaris", 6,
    2019, "13 WN6C 90", "Carex vaginata", 2,
    2019, "15 WN6N 95", "Carex vaginata", 3,
    2019, "22 WN5M 102", "Carex bigelowii", 7,
    2019, "24 WN5N 103", "Carex vaginata", 5,
    2019, "26 WN3I 105", "Carex bigelowii", 10,
    2019, "26 WN3I 105", "Carex capillaris", 5,
    2021, "26 WN3I 105", "Carex norvegica cf", 10,
    2020, "30 WN3M 107", "Carex bigelowii", 8,
    2019, "34 WN10I 114", "Carex capillaris", 4,
    2019, "36 WN10M 115", "Carex capillaris", 4,
    2019, "37 WN10C 116", "Carex capillaris", 6,
    2019, "41 WN7C 122", "Carex capillaris", 8,
    2019, "41 WN7C 122", "Carex vaginata", 12,
    2019, "44 WN7M 125", "Carex vaginata", 10,
    2021, "44 WN7M 125", "Carex vaginata", 10,
    2019, "47 WN7N 128", "Carex vaginata", 4,
    2021, "51 WN4M 132", "Carex bigelowii", 6,
    2019, "53 WN4C 133", "Carex bigelowii", 3,
    2021, "53 WN4C 133", "Carex norvegica cf", 1,
    2021, "53 WN4C 133", "Carex bigelowii", 4,
    2019, "56 WN4N 135", "Carex bigelowii", 5,
    2019, "56 WN4N 135", "Carex vaginata", 6,
    2019, "62 WN8M 141", "Carex bigelowii", 10,
    2021, "62 WN8M 141", "Carex bigelowii", 16,
    2019, "66 WN9I 147", "Carex bigelowii", 14,
    2019, "69 WN9C 150", "Carex vagninata", 5,
    2019, "73 WN2M 153", "Carex bigelowii", 10,
    2020, "73 WN2M 153", "Carex bigelowii", 4,
    2020, "74 WN2C 155", "Carex bigelowii", 10,
    2019, "78 WN2I 158", "Carex bigelowii", 6,
    2019, "78 WN2I 158", "Carex capillaris", 3,
    2020, "78 WN2I 158", "Carex capillaris", 2,
    2021, "80 WN2N 159", "Carex vaginata", 8,
  )
  
  
  ## Adds cover for new species
  # This needs doing if species was missing, or species was split into 2 species according to other years or pictures
  add_cover = tribble(
    ~year, ~turfID, ~species, ~cover,
    2019, "1 WN1M 84", "Leontodon autumnalis", 1,
    2019, "5 WN1I 86", "Leontodon autumnalis",  1,
    2019, "30 WN3M 107", "Luzula multiflora cf", 1,
    2019, "36 WN10M 115", "Taraxacum sp.", 1,
    2019, "53 WN4C 133", "Taraxacum sp.", 1,
    2019, "54 WN4I 134", "Taraxacum sp.", 2,
    2019, "11 AN6I 11", "Taraxacum sp.", 2,
    2019, "15 WN6N 95", "Leontodon autumnalis", 2,
    2019, "16 AN6N 16", "Taraxacum sp.", 6,
    2019, "20 AN5I 20", "Geranium sylvaticum", 5,
    2019, "20 AN5I 20", "Taraxacum sp.", 4,
    2019, "23 AN5N 23", "Antennaria sp", 2,
    2019, "38 AN10M 38", "Taraxacum sp.", 2,
    2019, "43 AN7C 43", "Taraxacum sp.", 1,
    2019, "45 AN7I 45", "Festuca ovina", 1,
    2019, "45 AN7I 45", "Taraxacum sp.", 1,
    2019, "46 AN7M 46", "Taraxacum sp.", 2,
    2019, "50 AN4M 50", "Taraxacum sp.", 8,
    2019, "57 AN8C 57", "Taraxacum sp.", 4,
    2019, "58 AN8I 58", "Taraxacum sp.", 8,
    2019, "63 AN8N 63", "Taraxacum sp.", 5,
    2019, "142 AN8C 142", "Carex bigelowii", 5,
    2019, "160 AN2N 160", "Carex pilulifera cf", 3,
    2020, "160 AN2N 160", "Carex pilulifera cf", 3,
    2022, "160 AN2N 160", "Carex pilulifera cf", 3,
    
    2020, "2 AN1M 2", "Carex atrata cf", 2,
    2019, "4 AN1C 4", "Carex vaginata", 5,
    2020, "4 AN1C 4", "Carex atrata cf", 2,
    2019, "6 AN1I 6", "Carex atrata cf", 4,
    2021, "6 AN1I 6", "Carex atrata cf", 4,
    2019, "6 AN1I 6", "Carex vaginata", 8,
    2019, "7 AN1N 7", "Carex atrata cf", 5,
    2021, "7 AN1N 7", "Carex atrata cf", 5,
    2021, "17 AN5M 17", "Carex bigelowii", 2,
    2022, "20 AN5I 20", "Carex vaginata", 3,
    2021, "23 AN5N 23", "Carex atrata cf", 2,
    2021, "28 AN3I 28", "Carex bigelowii", 3,
    2019, "35 AN10C 35", "Carex vaginata", 4,
    2019, "39 AN10N 39", "Carex vaginata", 1,
    2021, "39 AN10N 39", "Carex vaginata", 3,
    2019, "43 AN7C 43", "Carex vaginata", 12,
    2019, "46 AN7M 46", "Carex bigelowii", 4,
    2021, "46 AN7M 46", "Carex bigelowii", 5,
    2019, "46 AN7M 46", "Carex vaginata", 5,
    2021, "75 AN2I 75", "Carex bigelowii", 4,
    2021, "79 AN2N 79", "Carex capillaris", 2,
    
    2019, "8 WN1N 87", "Carex rupestris", 4,
    2021, "26 WN3I 105", "Carex bigelowii", 10,
    2019, "34 WN10I 114", "Carex vaginata", 2,
    2019, "34 WN10I 114", "Carex rupestris", 2,
    2019, "36 WN10M 115", "Carex bigelowii", 4,
    2019, "37 WN10C 116", "Carex rupestris", 10,
    2019, "41 WN7C 122", "Carex rupestris", 4,
    2019, "44 WN7M 125", "Carex bigelowii", 2,
    2021, "53 WN4C 133", "Carex vaginata", 6,
    2019, "62 WN8M 141", "Carex vaginata", 4,
    2019, "66 WN9I 147", "Carex vaginata", 4,
    2019, "73 WN2M 153", "Carex vaginata", 8,
    2022, "74 WN2C 155", "Carex pilulifera cf", 3,
    2019, "78 WN2I 158", "Carex vaginata", 6,
    
  )  %>% 
    # needs joining with metadata, because these are new entries
    left_join(metaTurfID, by = "turfID")
  # need to add 5 WN1I 86 Leo aut in cover dataset. Full record.
  
  
  
  ## Remove species using anti_join
  # This is needed for species that were misidentified and only some of the subplots are change to another species
  remove_wrong_species = tibble::tribble(
    ~year, ~turfID, ~species,
    2020, "83 AN1I 83", "Phleum alpinum",
    2020, "83 AN1I 83", "Avenella flexuosa",
    2019, "5 WN1I 86", "Festuca ovina",
    2019, "13 WN6C 90", "Festuca rubra",
    2019, "21 WN5C 99", "Taraxacum sp.",
    2019, "36 WN10M 115", "Phleum alpinum",
    2019, "20 AN5I 20", "Avenella flexuosa",
    2019, "52 AN4C 52", "Antennaria alpina cf",
    2019, "155 WN2M 198", "Carex small bigelowii",
    2019, "153 WN2I 197", "Carex small bigelowii",
    2019, "154 AN2M 154", "Carex small bigelowii",
    2022, "157 AN2I 157", "Carex canescens cf",
    2019, "143 WN8N 192", "Carex small bigelowii",
    
    2019, "2 AN1M 2", "Carex panicea cf",
    2019, "2 AN1M 2", "Carex small bigelowii",
    2019, "4 AN1C 4", "Carex saxatilis cf",
    2019, "4 AN1C 4", "Carex capillaris wide",
    2019, "4 AN1C 4", "Carex brunnescens cf",
    2019, "6 AN1I 6", "Carex capillaris wide",
    2019, "7 AN1N 7", "Carex saxatilis cf",
    2019, "7 AN1N 7", "Carex panicea cf",
    2020, "7 AN1N 7", "Carex dark green",
    2021, "9 AN6M 9", "Carex rupestris",
    2022, "9 AN6M 9", "Carex rupestris",
    2019, "11 AN6I 11", "Carex light green",
    2019, "11 AN6I 11", "Carex small bigelowii",
    2019, "12 AN6C 12", "Carex small bigelowii",
    2019, "17 AN5M 17", "Carex brunnescens cf",
    2019, "17 AN5M 17", "Carex small bigelowii",
    2019, "18 AN5C 18", "Carex capillaris wide",
    2019, "23 AN5N 23", "Carex saxatilis cf",
    2019, "23 AN5N 23", "Carex small bigelowii",
    2021, "23 AN5N 23", "Carex norvegica cf",
    2019, "27 AN3C 27", "Carex saxatilis cf",
    2019, "27 AN3C 27", "Carex light green",
    2020, "27 AN3C 27", "Carex dark green",
    2021, "27 AN3C 27", "Carex norvegica cf",
    2019, "28 AN3I 28", "Carex small bigelowii",
    2019, "33 AN10I 33", "Carex saxatilis cf",
    2021, "33 AN10I 33", "Carex capillaris cf",
    2021, "39 AN10N 39", "Carex norvegica cf",
    2019, "48 AN7N 48", "Carex norvegica cf",
    2019, "48 AN7N 48", "Carex panicea cf",
    2019, "50 AN4M 50", "Carex saxatilis cf",
    2019, "55 AN4N 55", "Carex thin",
    2019, "58 AN8I 58", "Carex atrata cf",
    2019, "58 AN8I 58", "Carex saxatilis cf",
    2019, "58 AN8I 58", "Carex panicea cf",
    2019, "67 AN9M 67", "Carex small bigelowii",
    2019, "67 AN9M 67", "Carex panicea cf",
    2019, "67 AN9M 67", "Carex capillaris wide",
    2019, "68 AN9I 68", "Carex small bigelowii",
    2019, "72 AN9N 72", "Carex atrata cf",
    2019, "72 AN9N 72", "Carex saxatilis cf",
    2019, "72 AN9N 72", "Carex thin",
    2021, "72 AN9N 72", "Carex norvegica cf",
    2019, "75 AN2I 75", "Carex atrata cf",
    2019, "75 AN2I 75", "Carex dark green",
    2019, "75 AN2I 75", "Carex small bigelowii",
    2021, "75 AN2I 75", "Carex norvegica cf",
    2019, "79 AN2N 79", "Carex light green",
    2021, "80 WN2N 159", "Carex saxatilis cf",
    
    2019, "3 WN1C 85", "Carex panicea cf",
    2020, "3 WN1C 85", "Carex sp",
    2020, "5 WN1I 86", "Carex dark green",
    2020, "5 WN1I 86", "Carex sp",
    2019, "13 WN6C 90", "Carex capillaris wide",
    2019, "15 WN6N 95", "Carex saxatilis cf",
    2019, "22 WN5M 102", "Carex atrata cf",
    2019, "24 WN5N 103", "Carex saxatilis cf",
    2020, "30 WN3M 107", "Carex dark green",
    2019, "32 WN3N 112", "Carex panicea cf",
    2019, "44 WN7M 125", "Carex saxatilis cf",
    2021, "44 WN7M 125", "Carex norvegica cf",
    2019, "47 WN7N 128", "Carex saxatilis cf",
    2021, "51 WN4M 132", "Carex atrata cf",
    2019, "53 WN4C 133", "Carex small bigelowii",
    2019, "56 WN4N 135", "Carex small bigelowii",
    2019, "56 WN4N 135", "Carex dark green",
    2021, "62 WN8M 141", "Carex norvegica cf",
    2019, "69 WN9C 150", "Carex small bigelowii",
    2020, "73 WN2M 153", "Carex small bigelowii",
    2020, "74 WN2C 155", "Carex sp",
    2019, "78 WN2I 158", "Carex thin",
    2020, "78 WN2I 158", "Carex thin",
    
    
  )
  
  cover_clean <- community_clean %>% 
    ungroup() %>% 
    select(origSiteID:species, cover:file) %>% 
    filter(!species %in% c("Moss layer", "Vascular plant layer", "SumofCover", "Vascular plants", "Bryophytes", "Lichen", "Litter", "Bare soil", "Bare rock", "Poop", "Unknown seedlings", "Wool")) %>% 
    
    # fix errors
    # fix wrong species
    left_join(fix_species, by = c("year", "turfID", "species")) %>% 
    mutate(species = if_else(!is.na(species_new), species_new, species)) %>%
    select(-species_new) %>% 
    # fix wrong cover
    left_join(fix_cover, by = c("year", "turfID", "species")) %>% 
    mutate(cover = if_else(!is.na(cover_new), cover_new, cover)) %>%
    select(-cover_new) %>% 
    # add cover
    bind_rows(add_cover |> select(-Namount_kg_ha_y)) %>% 
    # remove species that have been replaced
    tidylog::anti_join(remove_wrong_species, by = c("year", "turfID", "species")) |> 
    # rename last carex
    mutate(species = if_else(species == "Carex sp1", "Carex sp", species),
           species = if_else(species == "Orchid sp", "Unknown orchid", species)) |> 
    # add N amount variable
    left_join(metaTurfID)
  
}
